<% include ../header %>
<script>
	known_hexabus_devices = <%- JSON.stringify(devices) %>;
</script>

<div class="container" data-ng-controller="stateMachine">
	<div >
		<h3 data-localize="wizard.state-machine.new">New state machine</h3>
		<p class="lead" data-ng-hide="machineProp" data-localize="wizard.state-machine.choose">Choose a ... from below.</p>
		<select data-ng-model="machineProp">
			<option value="master_slave">Master/Slave</option>
			<option value="standykiller">Standby killer</option>
		</select>
	</div>
	<div data-ng-show="machineProp=='master_slave'">
		<p data-localize="wizard.state-machine.choose-master">Choose master</p>
			<select data-ng-model="masterProp" data-ng-options="value.ip as value.name for (key,value) in devices">
		</select>
		<p>
			<input data-ng-model="thresholdProp">
			<span data-localize="wizard.state-machine.choose-threshold">Choose threshold</span>
		</p>
		<p data-localize="wizard.state-machine.add-slaves">Add slaves</p>
		<div data-ng-repeat="slave in slaves" >
			<select data-ng-model="slave.ip" data-ng-options="value.ip as value.name for (key,value) in devices">
			</select>
		</div>
		<button class="btn btn-success" data-localize="wizard.state-machine.add-slave" data-ng-click="addSlave()">Add Slave</button>
		<button class="btn btn-success" data-localize="wizard.state-machine.upload" data-ng-click="send_master_slave()">Upload</button>
	</div>
	<div data-ng-show="machineProp=='standykiller'">
		<p data-localize="wizard.state-machine.choose-device">Choose device</p>
			<select data-ng-model="deviceProp" data-ng-options="value.ip as value.name for (key,value) in devices">
		</select>
		<p>
			<input data-ng-model="thresholdProp">
			<span data-localize="wizard.state-machine.choose-threshold">Choose threshold</span>
		</p>
		<p>
			<input data-ng-model="timeoutProp">
			<span data-localize="wizard.state-machine.choose-timeout">Choose timeout</span>
		</p>
		<button class="btn btn-success" data-localize="wizard.state-machine.upload" data-ng-click="send_standykiller()">Upload</button>
	</div>
</div>

<% include ../footer %>
